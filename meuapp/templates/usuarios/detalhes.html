{% extends 'base.html' %}

{% block title %}Detalhes de {{ usuario.get_full_name|default:usuario.username }} — DevLab{% endblock %}

{% block content %}
<div class="container-fluid">

    <!-- Cabeçalho da Página -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <div>
            <h1 class="h3 mb-1 text-gray-800">{{ usuario.get_full_name|default:usuario.username }}</h1>
            <span class="badge bg-primary">{{ usuario.get_tipo_display }}</span>
        </div>
        <div>
            <a href="{% url 'usuario_editar' pk=usuario.pk %}" class="btn btn-warning btn-icon-split">
                <span class="icon text-white-50">
                    <i class="fas fa-edit"></i>
                </span>
                <span class="text">Editar</span>
            </a>
            <a href="{% url 'usuario_deletar' pk=usuario.pk %}" class="btn btn-danger btn-icon-split">
                <span class="icon text-white-50">
                    <i class="fas fa-trash"></i>
                </span>
                <span class="text">Deletar</span>
            </a>
        </div>
    </div>

    <div class="row">
        <!-- Coluna de Informações Pessoais -->
        <div class="col-lg-6">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Informações Pessoais</h6>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Nome de Usuário:</strong>
                            <span>{{ usuario.username }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Email:</strong>
                            <a href="mailto:{{ usuario.email }}">{{ usuario.email }}</a>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Matrícula:</strong>
                            <span>{{ usuario.matricula|default:"Não informada" }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>CPF:</strong>
                            <span>{{ usuario.cpf|default:"Não informado" }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Função:</strong>
                            <span>{{ usuario.funcao|default:"Não informada" }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Data de Nascimento:</strong>
                            <span>{{ usuario.data_nascimento|date:"d/m/Y"|default:"Não informada" }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Status:</strong>
                            {% if usuario.is_active %}
                                <span class="badge bg-success">Ativo</span>
                            {% else %}
                                <span class="badge bg-danger">Inativo</span>
                            {% endif %}
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong>Membro desde:</strong>
                            <span>{{ usuario.date_joined|date:"d/m/Y" }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Coluna de Participações -->
        <div class="col-lg-6">
            <!-- Card de Equipes -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Participação em Equipes</h6>
                </div>
                <div class="card-body">
                    {% if equipes_participando %}
                        <ul class="list-group">
                            {% for equipe in equipes_participando %}
                                <li class="list-group-item">
                                    <a href="{% url 'equipe_detalhes' pk=equipe.pk %}">{{ equipe.nome }}</a>
                                    {% if equipe == usuario.equipe_liderada %}
                                        <span class="badge bg-info ms-2">Líder</span>
                                    {% endif %}
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">Este usuário não participa de nenhuma equipe.</p>
                    {% endif %}
                </div>
            </div>

            <!-- Card de Projetos -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Participação em Projetos</h6>
                </div>
                <div class="card-body">
                    {% if projetos_participando %}
                        <ul class="list-group">
                            {% for projeto in projetos_participando %}
                                <li class="list-group-item"><a href="{% url 'projeto_detalhes' pk=projeto.pk %}">{{ projeto.titulo }}</a></li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">Este usuário não está diretamente associado a nenhum projeto.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <a href="{% url 'usuario_lista' %}" class="btn btn-secondary">&larr; Voltar para a lista de usuários</a>

</div>
{% endblock %}